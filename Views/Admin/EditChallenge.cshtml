@model Shinogi.ViewModels.ChallengeEditViewModel
@{
    var functions = new[] { ("linear", "Linear"), ("log", "Log"), ("exp", "Exp") };
    var logics = new[] { ("any", "Any"), ("all", "All"), ("teamconsensus", "Team Consensus") };
}
<section>
    <h1>Edit Challenge</h1>
    <form method="post" asp-action="UpdateChallenge" asp-route-id="@Model.Id" class="form form-wide">
        <label>Name<input name="Name" value="@Model.Name" required /></label>
        <label>Category
            <select name="Category" required>
                <option value="">-- 選択 --</option>
                @foreach (var cat in Model.Categories)
                {
                    if (cat == Model.Category)
                    {
                        <option value="@cat" selected>@cat</option>
                    }
                    else
                    {
                        <option value="@cat">@cat</option>
                    }
                }
            </select>
        </label>
        <label>Difficulty
            <select name="Difficulty">
                <option value="">-- 選択 --</option>
                @foreach (var diff in Model.Difficulties)
                {
                    if (diff == Model.Difficulty)
                    {
                        <option value="@diff" selected>@diff</option>
                    }
                    else
                    {
                        <option value="@diff">@diff</option>
                    }
                }
            </select>
        </label>
        <label>Description<textarea name="Description" rows="3">@Model.Description</textarea></label>
        <label>Value Initial<input name="ValueInitial" type="number" value="@Model.ValueInitial" /></label>
        <label>Value Minimum<input name="ValueMinimum" type="number" value="@Model.ValueMinimum" /></label>
        <label>Decay<input name="Decay" type="number" value="@Model.Decay" /></label>
        <label>Function
            <select name="Function">
                @foreach (var (val, label) in functions)
                {
                    if (val.Equals(Model.Function, StringComparison.OrdinalIgnoreCase))
                    {
                        <option value="@val" selected>@label</option>
                    }
                    else
                    {
                        <option value="@val">@label</option>
                    }
                }
            </select>
        </label>
        <label>Logic
            <select name="Logic">
                @foreach (var (val, label) in logics)
                {
                    if (val.Equals(Model.Logic, StringComparison.OrdinalIgnoreCase))
                    {
                        <option value="@val" selected>@label</option>
                    }
                    else
                    {
                        <option value="@val">@label</option>
                    }
                }
            </select>
        </label>
        <label>Max Attempts (optional)
            <input name="MaxAttempts" type="number" value="@(Model.MaxAttempts.HasValue ? Model.MaxAttempts.Value.ToString() : "")" />
        </label>
        <label>出題時刻 (空欄で即時公開)
            <input type="datetime-local" name="ReleaseAt" value="@Model.ReleaseAt" />
        </label>
        <div style="display:flex; align-items:center; gap:10px;">
            <label class="toggle-switch" title="@(Model.Published ? "公開中" : "非公開")">
                <input name="Published" type="checkbox" value="true" @(Model.Published ? "checked" : "") />
                <span class="toggle-slider"></span>
            </label>
            <span style="color:var(--primary-muted); font-size:14px;">Published</span>
        </div>
        <button type="submit">Save</button>
    </form>
    <p style="margin-top:16px;"><a asp-action="Challenges">&larr; Back</a></p>
</section>
